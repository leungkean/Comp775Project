Metal device set to: Apple M1
systemMemory: 8.00 GB
maxCacheSize: 2.67 GB
Model: "u_net"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to
==================================================================================================
 x (InputLayer)                 [(None, 128, 128, 3  0           []
                                )]
 b (InputLayer)                 [(None, 128, 128, 1  0           []
                                )]
 multiply (Multiply)            (None, 128, 128, 3)  0           ['x[0][0]',
                                                                  'b[0][0]']
 conv2d (Conv2D)                (None, 128, 128, 64  1792        ['multiply[0][0]']
                                )
 conv2d_1 (Conv2D)              (None, 128, 128, 64  36928       ['conv2d[0][0]']
                                )
 max_pooling2d (MaxPooling2D)   (None, 64, 64, 64)   0           ['conv2d_1[0][0]']
 conv2d_2 (Conv2D)              (None, 64, 64, 128)  73856       ['max_pooling2d[0][0]']
 conv2d_3 (Conv2D)              (None, 64, 64, 128)  147584      ['conv2d_2[0][0]']
 dropout (Dropout)              (None, 64, 64, 128)  0           ['conv2d_3[0][0]']
 max_pooling2d_1 (MaxPooling2D)  (None, 32, 32, 128)  0          ['dropout[0][0]']
 conv2d_4 (Conv2D)              (None, 32, 32, 256)  295168      ['max_pooling2d_1[0][0]']
 conv2d_5 (Conv2D)              (None, 32, 32, 256)  590080      ['conv2d_4[0][0]']
 up_sampling2d (UpSampling2D)   (None, 64, 64, 256)  0           ['conv2d_5[0][0]']
 conv2d_6 (Conv2D)              (None, 64, 64, 128)  131200      ['up_sampling2d[0][0]']
 concatenate (Concatenate)      (None, 64, 64, 256)  0           ['conv2d_3[0][0]',
                                                                  'conv2d_6[0][0]']
 conv2d_7 (Conv2D)              (None, 64, 64, 128)  295040      ['concatenate[0][0]']
 conv2d_8 (Conv2D)              (None, 64, 64, 128)  147584      ['conv2d_7[0][0]']
 up_sampling2d_1 (UpSampling2D)  (None, 128, 128, 12  0          ['conv2d_8[0][0]']
                                8)
 conv2d_9 (Conv2D)              (None, 128, 128, 64  32832       ['up_sampling2d_1[0][0]']
                                )
 concatenate_1 (Concatenate)    (None, 128, 128, 12  0           ['conv2d_1[0][0]',
                                8)                                'conv2d_9[0][0]']
 conv2d_10 (Conv2D)             (None, 128, 128, 64  73792       ['concatenate_1[0][0]']
                                )
 conv2d_11 (Conv2D)             (None, 128, 128, 64  36928       ['conv2d_10[0][0]']
                                )
 conv2d_12 (Conv2D)             (None, 128, 128, 2)  1154        ['conv2d_11[0][0]']
 conv2d_13 (Conv2D)             (None, 128, 128, 1)  3           ['conv2d_12[0][0]']
==================================================================================================
Total params: 1,863,941
Trainable params: 1,863,941
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/10
[34m[1mwandb[39m[22m: [33mWARNING[39m The save_model argument by default saves the model in the HDF5 format that cannot save custom objects like subclassed models and custom layers. This behavior will be deprecated in a future release in favor of the SavedModel format. Meanwhile, the HDF5 model is saved as W&B files and the SavedModel as W&B Artifacts.
2022-12-01 19:46:21.455742: W tensorflow/core/platform/profile_utils/cpu_utils.cc:128] Failed to get CPU frequency: 0 Hz
Corrupt JPEG data: 240 extraneous bytes before marker 0xd9
Corrupt JPEG data: premature end of data segment




































































106/115 [==========================>...] - ETA: 11s - loss: 2.5334 - accuracy: 0.5823
Corrupt JPEG data: 240 extraneous bytes before marker 0xd9





115/115 [==============================] - 151s 1s/step - loss: 2.5304 - accuracy: 0.5817 - _timestamp: 1669942132.0000 - _runtime: 156.0000
Epoch 2/10





































































106/115 [==========================>...] - ETA: 11s - loss: 2.4674 - accuracy: 0.5814
Corrupt JPEG data: 240 extraneous bytes before marker 0xd9





115/115 [==============================] - 152s 1s/step - loss: 2.4665 - accuracy: 0.5817 - _timestamp: 1669942284.0000 - _runtime: 308.0000
Epoch 3/10



































































106/115 [==========================>...] - ETA: 11s - loss: 2.4614 - accuracy: 0.5812
Corrupt JPEG data: 240 extraneous bytes before marker 0xd9





115/115 [==============================] - 146s 1s/step - loss: 2.4626 - accuracy: 0.5817 - _timestamp: 1669942430.0000 - _runtime: 454.0000
Epoch 4/10

































































106/115 [==========================>...] - ETA: 11s - loss: 2.5100 - accuracy: 0.5816
Corrupt JPEG data: 240 extraneous bytes before marker 0xd9





115/115 [==============================] - 143s 1s/step - loss: 2.5134 - accuracy: 0.5817 - _timestamp: 1669942573.0000 - _runtime: 597.0000
Epoch 5/10


































































106/115 [==========================>...] - ETA: 11s - loss: 2.6177 - accuracy: 0.5825
Corrupt JPEG data: 240 extraneous bytes before marker 0xd9





115/115 [==============================] - 144s 1s/step - loss: 2.6235 - accuracy: 0.5817 - _timestamp: 1669942717.0000 - _runtime: 741.0000
Epoch 6/10
































































105/115 [==========================>...] - ETA: 12s - loss: 2.7850 - accuracy: 0.5831
Corrupt JPEG data: 240 extraneous bytes before marker 0xd9





115/115 [==============================] - 142s 1s/step - loss: 2.7941 - accuracy: 0.5817 - _timestamp: 1669942859.0000 - _runtime: 883.0000
Epoch 7/10
































































106/115 [==========================>...] - ETA: 11s - loss: 3.0126 - accuracy: 0.5830
Corrupt JPEG data: 240 extraneous bytes before marker 0xd9





115/115 [==============================] - 141s 1s/step - loss: 3.0229 - accuracy: 0.5817 - _timestamp: 1669943000.0000 - _runtime: 1024.0000
Epoch 8/10

































































105/115 [==========================>...] - ETA: 12s - loss: 3.2923 - accuracy: 0.5817
Corrupt JPEG data: 240 extraneous bytes before marker 0xd9





115/115 [==============================] - 144s 1s/step - loss: 3.3060 - accuracy: 0.5817 - _timestamp: 1669943144.0000 - _runtime: 1168.0000
Epoch 9/10


































































106/115 [==========================>...] - ETA: 11s - loss: 3.6253 - accuracy: 0.5826
Corrupt JPEG data: 240 extraneous bytes before marker 0xd9





115/115 [==============================] - 146s 1s/step - loss: 3.6396 - accuracy: 0.5817 - _timestamp: 1669943290.0000 - _runtime: 1314.0000
Epoch 10/10





































































106/115 [==========================>...] - ETA: 11s - loss: 4.0045 - accuracy: 0.5816
Corrupt JPEG data: 240 extraneous bytes before marker 0xd9






115/115 [==============================] - 151s 1s/step - loss: 4.0205 - accuracy: 0.5817 - _timestamp: 1669943441.0000 - _runtime: 1465.0000
WARNING:absl:Found untraced functions such as _jit_compiled_convolution_op, _jit_compiled_convolution_op, _jit_compiled_convolution_op, _jit_compiled_convolution_op, _jit_compiled_convolution_op while saving (showing 5 of 14). These functions will not be directly callable after loading.
Traceback (most recent call last):
  File "/Users/keanl/Desktop/Computer_Science/Comp_775/project/Comp775Project/train_unet_pet.py", line 184, in <module>
    main()
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.9/site-packages/click/core.py", line 1128, in __call__
    return self.main(*args, **kwargs)
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.9/site-packages/click/core.py", line 1053, in main
    rv = self.invoke(ctx)
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.9/site-packages/click/core.py", line 1395, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.9/site-packages/click/core.py", line 754, in invoke
    return __callback(*args, **kwargs)
  File "/Users/keanl/Desktop/Computer_Science/Comp_775/project/Comp775Project/train_unet_pet.py", line 152, in main
    model_artifact = wandb.Artifact(f"{dataset}_unet_classifier", type="classifier")
NameError: name 'dataset' is not defined