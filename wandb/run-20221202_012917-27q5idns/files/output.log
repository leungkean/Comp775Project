[34m[1mwandb[39m[22m: [33mWARNING[39m The save_model argument by default saves the model in the HDF5 format that cannot save custom objects like subclassed models and custom layers. This behavior will be deprecated in a future release in favor of the SavedModel format. Meanwhile, the HDF5 model is saved as W&B files and the SavedModel as W&B Artifacts.
2022-12-02 01:29:22.859298: W tensorflow/core/platform/profile_utils/cpu_utils.cc:128] Failed to get CPU frequency: 0 Hz
Metal device set to: Apple M1
systemMemory: 8.00 GB
maxCacheSize: 2.67 GB
Model: "u_net"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to
==================================================================================================
 x (InputLayer)                 [(None, 128, 128, 3  0           []
                                )]
 b (InputLayer)                 [(None, 128, 128, 1  0           []
                                )]
 multiply (Multiply)            (None, 128, 128, 3)  0           ['x[0][0]',
                                                                  'b[0][0]']
 conv2d (Conv2D)                (None, 128, 128, 64  1792        ['multiply[0][0]']
                                )
 conv2d_1 (Conv2D)              (None, 128, 128, 64  36928       ['conv2d[0][0]']
                                )
 dropout (Dropout)              (None, 128, 128, 64  0           ['conv2d_1[0][0]']
                                )
 max_pooling2d (MaxPooling2D)   (None, 64, 64, 64)   0           ['dropout[0][0]']
 conv2d_2 (Conv2D)              (None, 64, 64, 128)  73856       ['max_pooling2d[0][0]']
 conv2d_3 (Conv2D)              (None, 64, 64, 128)  147584      ['conv2d_2[0][0]']
 up_sampling2d (UpSampling2D)   (None, 128, 128, 12  0           ['conv2d_3[0][0]']
                                8)
 conv2d_4 (Conv2D)              (None, 128, 128, 64  32832       ['up_sampling2d[0][0]']
                                )
 concatenate (Concatenate)      (None, 128, 128, 12  0           ['conv2d_1[0][0]',
                                8)                                'conv2d_4[0][0]']
 conv2d_5 (Conv2D)              (None, 128, 128, 64  73792       ['concatenate[0][0]']
                                )
 conv2d_6 (Conv2D)              (None, 128, 128, 64  36928       ['conv2d_5[0][0]']
                                )
 conv2d_7 (Conv2D)              (None, 128, 128, 2)  1154        ['conv2d_6[0][0]']
 conv2d_8 (Conv2D)              (None, 128, 128, 1)  3           ['conv2d_7[0][0]']
==================================================================================================
Total params: 404,869
Trainable params: 404,869
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/20






10/10 [==============================] - 19s 2s/step - loss: 0.6691 - accuracy: 0.9118 - val_loss: 0.4922 - val_accuracy: 0.8946 - _timestamp: 1669962581.0000 - _runtime: 24.0000
Epoch 2/20






10/10 [==============================] - 16s 2s/step - loss: 0.3660 - accuracy: 0.9311 - val_loss: 0.3992 - val_accuracy: 0.8946 - _timestamp: 1669962597.0000 - _runtime: 40.0000
Epoch 3/20




10/10 [==============================] - 13s 1s/step - loss: 0.3021 - accuracy: 0.9228 - val_loss: 0.3523 - val_accuracy: 0.8946 - _timestamp: 1669962609.0000 - _runtime: 52.0000
Epoch 4/20






10/10 [==============================] - 16s 2s/step - loss: 0.2731 - accuracy: 0.9257 - val_loss: 0.3255 - val_accuracy: 0.8946 - _timestamp: 1669962625.0000 - _runtime: 68.0000
Epoch 5/20





10/10 [==============================] - 15s 1s/step - loss: 0.2587 - accuracy: 0.9271 - val_loss: 0.3152 - val_accuracy: 0.8946 - _timestamp: 1669962640.0000 - _runtime: 83.0000
Epoch 6/20






10/10 [==============================] - 15s 1s/step - loss: 0.2529 - accuracy: 0.9253 - val_loss: 0.2906 - val_accuracy: 0.8946 - _timestamp: 1669962654.0000 - _runtime: 97.0000
Epoch 7/20






10/10 [==============================] - 16s 2s/step - loss: 0.2544 - accuracy: 0.9250 - val_loss: 0.3253 - val_accuracy: 0.8946 - _timestamp: 1669962670.0000 - _runtime: 113.0000
Epoch 8/20







10/10 [==============================] - 21s 2s/step - loss: 0.2496 - accuracy: 0.9292 - val_loss: 0.3242 - val_accuracy: 0.8946 - _timestamp: 1669962691.0000 - _runtime: 134.0000
Epoch 9/20






 8/10 [=======================>......] - ETA: 3s - loss: 0.2539 - accuracy: 0.9217
Error: command buffer exited with error status.
	The Metal Performance Shaders operations encoded on it may not have completed.
	Error:
	(null)
	Internal Error (0000000e:Internal Error)
	<AGXG13GFamilyCommandBuffer: 0x35c5bda00>
    label = <none>
    device = <AGXG13GDevice: 0x17201d600>
        name = Apple M1
    commandQueue = <AGXG13GFamilyCommandQueue: 0x29e0b6800>
        label = <none>
        device = <AGXG13GDevice: 0x17201d600>
            name = Apple M1

10/10 [==============================] - 19s 2s/step - loss: 0.2480 - accuracy: 0.9239 - val_loss: 0.2775 - val_accuracy: 0.8946 - _timestamp: 1669962710.0000 - _runtime: 153.0000
Epoch 10/20







10/10 [==============================] - 17s 2s/step - loss: 0.2415 - accuracy: 0.9246 - val_loss: 0.2841 - val_accuracy: 0.8946 - _timestamp: 1669962728.0000 - _runtime: 171.0000
Epoch 11/20



10/10 [==============================] - 9s 821ms/step - loss: 0.2387 - accuracy: 0.9240 - val_loss: 0.2763 - val_accuracy: 0.8946 - _timestamp: 1669962737.0000 - _runtime: 180.0000
Epoch 12/20


10/10 [==============================] - 7s 733ms/step - loss: 0.2246 - accuracy: 0.9296 - val_loss: 0.2757 - val_accuracy: 0.8946 - _timestamp: 1669962744.0000 - _runtime: 187.0000
Epoch 13/20


10/10 [==============================] - 8s 788ms/step - loss: 0.2356 - accuracy: 0.9244 - val_loss: 0.2872 - val_accuracy: 0.8946 - _timestamp: 1669962752.0000 - _runtime: 195.0000
Epoch 14/20


10/10 [==============================] - 7s 725ms/step - loss: 0.2220 - accuracy: 0.9288 - val_loss: 0.3087 - val_accuracy: 0.8946 - _timestamp: 1669962759.0000 - _runtime: 202.0000
Epoch 15/20



10/10 [==============================] - 8s 778ms/step - loss: 0.2333 - accuracy: 0.9250 - val_loss: 0.3230 - val_accuracy: 0.8946 - _timestamp: 1669962767.0000 - _runtime: 210.0000
Epoch 16/20



10/10 [==============================] - 9s 869ms/step - loss: 0.2366 - accuracy: 0.9271 - val_loss: 0.3105 - val_accuracy: 0.8946 - _timestamp: 1669962776.0000 - _runtime: 219.0000
Epoch 17/20



10/10 [==============================] - 8s 751ms/step - loss: 0.2342 - accuracy: 0.9264 - val_loss: 0.3128 - val_accuracy: 0.8946 - _timestamp: 1669962783.0000 - _runtime: 226.0000
Epoch 18/20


10/10 [==============================] - 7s 735ms/step - loss: 0.2349 - accuracy: 0.9244 - val_loss: 0.2839 - val_accuracy: 0.8946 - _timestamp: 1669962791.0000 - _runtime: 234.0000
Epoch 19/20


10/10 [==============================] - 8s 797ms/step - loss: 0.2372 - accuracy: 0.9259 - val_loss: 0.3006 - val_accuracy: 0.8946 - _timestamp: 1669962799.0000 - _runtime: 242.0000
Epoch 20/20



10/10 [==============================] - 8s 749ms/step - loss: 0.2377 - accuracy: 0.9241 - val_loss: 0.2735 - val_accuracy: 0.8946 - _timestamp: 1669962807.0000 - _runtime: 250.0000
WARNING:absl:Found untraced functions such as _jit_compiled_convolution_op, _jit_compiled_convolution_op, _jit_compiled_convolution_op, _jit_compiled_convolution_op, _jit_compiled_convolution_op while saving (showing 5 of 9). These functions will not be directly callable after loading.
[34m[1mwandb[39m[22m: Adding directory to artifact (/Users/keanl/Desktop/Computer_Science/Comp_775/project/Comp775Project/wandb/run-20221202_012917-27q5idns/files/model/1)... Done. 0.0s
1/1 [==============================] - 0s 173ms/step - loss: 1.0980 - accuracy: 0.8946
1/1 [==============================] - 0s 142ms/step - loss: 1.1931 - accuracy: 0.8946
1/1 [==============================] - 0s 143ms/step - loss: 1.0553 - accuracy: 0.8946
1/1 [==============================] - 0s 146ms/step - loss: 0.8948 - accuracy: 0.8946
1/1 [==============================] - 0s 143ms/step - loss: 0.7530 - accuracy: 0.8946
1/1 [==============================] - 0s 145ms/step - loss: 0.6012 - accuracy: 0.8946
1/1 [==============================] - 0s 146ms/step - loss: 0.4954 - accuracy: 0.8946
1/1 [==============================] - 0s 147ms/step - loss: 0.4158 - accuracy: 0.8946
1/1 [==============================] - 0s 144ms/step - loss: 0.3559 - accuracy: 0.8946
1/1 [==============================] - 0s 149ms/step - loss: 0.3175 - accuracy: 0.8946
1/1 [==============================] - 0s 142ms/step - loss: 0.2957 - accuracy: 0.8946
1/1 [==============================] - 0s 143ms/step - loss: 0.2835 - accuracy: 0.8946
1/1 [==============================] - 0s 144ms/step - loss: 0.2752 - accuracy: 0.8946
1/1 [==============================] - 0s 143ms/step - loss: 0.2725 - accuracy: 0.8946
1/1 [==============================] - 0s 142ms/step - loss: 0.2735 - accuracy: 0.8946
1/1 [==============================] - 0s 138ms/step - loss: 0.2733 - accuracy: 0.8946
1/1 [==============================] - 0s 137ms/step - loss: 0.2743 - accuracy: 0.8946
1/1 [==============================] - 0s 142ms/step - loss: 0.2743 - accuracy: 0.8946
1/1 [==============================] - 0s 144ms/step - loss: 0.2744 - accuracy: 0.8946
1/1 [==============================] - 0s 140ms/step - loss: 0.2744 - accuracy: 0.8946
1/1 [==============================] - 0s 140ms/step - loss: 0.2811 - accuracy: 0.8946